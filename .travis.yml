language: python

python:
- '3.5'

install:
- pip install -r requirements-test.txt

script:
- tox

env:
  matrix:
  - TOXENV=py27-django18
  - TOXENV=py27-django19
  - TOXENV=py27-django110
  - TOXENV=py34-django18
  - TOXENV=py34-django19
  - TOXENV=py34-django110
  - TOXENV=py35-django18
  - TOXENV=py35-django19
  - TOXENV=py35-django110
  - TOXENV=flake8
  - TOXENV=coverage

after_success: coveralls

jobs:
  include:
    - stage: deploy
      env: TOXENV=py35-django110
      deploy:
        provider: pypi
        user: thorgate
        password:
          secure: >
            ed+XJteAdeeS8DmnACV3UKSu/s/qMv6u6xPITGKQomkAhxuJFo3m8LRjm3lMnJI1NN8EIuYCiMjHPEEXXwqi8+uGwUzPNpqYwBjrK8v6TVUxY
            tNLIwTzhwRu+pt/V3BxnhyqTEwF0NAi+diIqeQVsVPl8lHrQRye+y4Sco33VKGtJi5+8qgdYnbh5xA5QeZmDSkT/n1mJE9C9p0O6Dlgco2kwC
            MI/YoCSM3y3jKH53ZMdYHf6FOWgMYoyaNjUEc2jGJyfp61X3+JQJhg8jxSFHNl06vzp+Eyei90RMMM/QccBSXUMSdAdXBXoDnmoQ7PGV8OUU5
            H4r9TCbwpP4UzyxboyE2MK9+XyyIPiP9Cj0z78oIBfYSINiOoEOwaSAgU8P49ok3Ba7oIKBWXeI13rgo2JSkWPTdhhHESmeVIeX30HoyY41u3
            eC3nPzsDIUdBzcgMK1bZ+4WgiEjsKpER7SPgpvxULBPHtaNZlnovRVD+QiYWnmxHbqnpLrgMCT3NRJsoWm9AZErHkRKzu3213kaDf1k7ivDad
            r7iZnEoDEj8Vjp1qQF0rnbu8/eFKh5XG/myNIihrfpy89A9Mp0mAuhaRweJyz3eGoio856o+3fF+bpUzi4qVN4vYRlryt+3nb0K5qamT60Zvk
            bP8SL3hRUQy0ifWFZW7q8tGSBcM+w=
        on:
          # Warning: With this config, the package is released on pypi after the first matrix job succeeeds. This is currently fine
          #           since we shouldn't create tags before a successful build. Travis plans to add after_success callback in Q1/Q2 of
          #           2017. See https://github.com/travis-ci/travis-ci/issues/929 for more info.
          tags: true
          distributions: sdist bdist_wheel
          repo: thorgate/tg-react

notifications:
    email: false
